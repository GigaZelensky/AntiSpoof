#        ___          __  _ _____                   ____
#       /   |  ____  / /_(_) ___/____  ____  ____  / __/
#      / /| | / __ \/ __/ /\__ \/ __ \/ __ \/ __ \/ /_  
#     / ___ |/ / / / /_/ /___/ / /_/ / /_/ / /_/ / __/  
#    /_/  |_/_/ /_/\__/_//____/ .___/\____/\____/_/     
#                            /_/                        
#                   Made by GigaZelensky

# ──────────────────────────────────────────────────────────
#                  AntiSpoof Configuration
# ──────────────────────────────────────────────────────────
# Welcome to AntiSpoof. This plugin helps server admins detect and manage 
# client-side modifications by analyzing client information sent by players.
#
# ⚠️ Note: While this plugin enhances security, it is not foolproof. 
# Skilled users can (ironically) spoof their client details to bypass detection.
#
# By default, the plugin only verifies whether a player claiming to use
# 'vanilla' has registered plugin channels, something that is impossible
# on a true vanilla client.
# ──────────────────────────────────────────────────────────

# Core plugin settings
settings:
  
  # ️ Debug Mode
  # If enabled, logs client channels and brand details in the console when a player logs in.
  debug: false
  
  # ⏳ Delay in seconds before running the first check after a player joins
  # This allows time for the client to send brand and channel information (Default: 1)
  delay-in-seconds: 1
  
  # ──────────────────────────────────────────────────────────
  #                 Discord Webhook Settings
  # ──────────────────────────────────────────────────────────
  discord:
    enabled: false
    webhook: ""
    
    # Embed appearance
    embed-title: "**AntiSpoof Alert**"
    embed-color: "#2AB7CA"
    username: "AntiSpoof Bot"  # Custom webhook username
    avatar-url: ""  # Optional avatar URL for the webhook
    
    # Mention settings
    mentions:
      roles: []  # List of role IDs to mention
      everyone: false  # Whether to @everyone 
    
    # Content customization
    content:
      include-player-uuid: false  # Include player UUID in webhook
      include-server-name: true   # Include server name in webhook
      include-timestamp: true     # Include timestamp in webhook
    
    # Field visibility
    fields:
      show-brand: true            # Show client brand
      show-channels: true         # Show registered channels
      show-violations: true       # Show violation details
      show-version: true          # Show client version (if available)
      
    # Violation batching
    batching:
      enabled: true               # Batch multiple violations into one alert
      cooldown: 5000              # Cooldown between alerts (milliseconds)

# ──────────────────────────────────────────────────────────
#                Bedrock Handling Settings
# ──────────────────────────────────────────────────────────
  # Bedrock players are never checked for spoofing
  # This section is to help detect Geyser spoofers
  bedrock:    
    # Alternative detection method if Floodgate API isn't available
    # A player will be filetered as a Bedock user by AntiSpoof if either or both
    # the prefix and Floodgate API shows they're a Bedrock player (If enabled)
    prefix-check:
      enabled: true
      prefix: "."  # Username prefix for Bedrock players

# ──────────────────────────────────────────────────────────
#                  Update Checker Settings
# ──────────────────────────────────────────────────────────
# Checks for updates from GitHub when the server starts
  update-checker:
    # Whether to check for plugin updates on startup
    enabled: true
    
    # Whether to notify admins when they join if an update is available
    notify-on-join: true

# =================================================================
#                       CLIENT PROFILES
# =================================================================
# All client detection is handled through profiles. Each profile
# defines patterns to match client brands and rules for what's
# allowed or flagged.
# =================================================================
profiles:
  # Global settings that apply to all profiles
  global: # Do not change this name, as it is hard-coded to be used as master
    # Global channel rules (applied alongside profile-specific rules)
    # Meaning all other profiles follow these rules
    channels:
      # Required channels
      required: []
      # Blocked channels
      blocked: []
      # Alert settings for channel violations
      alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cChannels do not match global whitelist"
      alert-message-console: "%player% flagged! Channels do not match global whitelist"
      discord-alert: true
      discord-alert-message: "Channels do not match global whitelist"
      punish: false
      punishments:
        - "kick %player% &cChannels do not match global whitelist"

      # Modified channels alerts (when a player registers new channels during the session)
      modified-channels:
        enabled: true
        alert-message: "&8[&cAntiSpoof&8] &e%player% modified channel: &f%channel%"
        console-alert-message: "%player% modified channel: %channel%"
        discord-alert: false
        discord-alert-message: "Modified channel: %channel%"

  # Default settings for unmatched clients 
  # Like the other groups, it follows the global logic and applies to all brands that are not included below
  # Used when a client brand doesn't match any other profile, meaning it's "unknown"
  default: # Do not change this name, as it is hard-coded to be used as fallback
    # Whether to flag clients that don't match any profile
    flag: true
    
    # Whether to alert staff about this client brand
    alert: true
    
    # Alert messages for default profile
    alert-message: "&8[&cAntiSpoof&8] &7%player% using unknown client: &e%brand%"
    console-alert-message: "%player% using unknown client: %brand%"
    discord-alert: true
    discord-alert-message: "Using unknown client brand" # Brand is always showed in the Discord webhook by default
    
    # Punishment settings
    punish: false
    punishments: []
  
  # =================== VANILLA CLIENT ===================
  # Detect legitimate vanilla clients and flag spoofing
  # ====================================================
  vanilla:
    # Whether this profile is enabled
    enabled: true
    
    # Client brand patterns to match (regex)
    patterns:
      - "^vanilla$"  # Exact match for "vanilla"
    
    # Channel rules specific to this profile
    channels:
      # Required channels (none for vanilla)
      required: []
      
      # Blocked channels (vanilla shouldn't have ANY channels)
      blocked: [".*"]  # All channels are blocked for vanilla
      # Alert when a player's channels do not match
      alert: true
      alert-message: '&8[&cAntiSpoof&8] &e%player% &cVanilla client with plugin channels'
      alert-message-console: "%player% flagged! Vanilla client with plugin channels"
      discord-alert: true
      discord-alert-message: "Vanilla client with plugin channels"
      punish: false
      punishments:
        - "kick %player% &cVanilla spoofing detected"
    # Whether to flag clients matching this profile
    # For vanilla, we don't flag vanilla by default
    # But we DO flag if they have channels based on 'channel-alert' settings (vanilla spoof detection by default)
    flag: false
    
    # Alert settings
    alert: false # It alerts vanilla spoofing based on the 'channel-alert' settings
    alert-message: "&8[&cAntiSpoof&8] &e%player% joined using &aVanilla"
    console-alert-message: "%player% joined using Vanilla"
    discord-alert: false
    
    # Punishment settings
    punish: false
    punishments:
      - "kick %player% &cVanilla clients are not allowed"

  # =================== NO BRAND ===================
  # Detect clients that don't send a brand
  # ================================================
  no-brand:
    # Whether this profile is enabled
    enabled: true
    
    # Match null or empty brand
    patterns:
      - "^$"
    
    # Flag this client type
    flag: true
    
    # Alert settings
    alert: true
    alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cNo client brand detected"
    console-alert-message: "%player% flagged! No client brand detected"
    discord-alert: true
    discord-alert-message: 
    
    # Punishment settings
    punish: false
    punishments:
      - "kick %player% &cNo client brand detected"

  # =================== GEYSER CLIENT ===================
  # Handle Geyser (Bedrock) clients
  # =====================================================
  geyser:
    # Whether this profile is enabled
    enabled: true
    
    # Match any brand containing "geyser" (case insensitive)
    patterns:
      - "(?i).*geyser.*"
    
    # Don't flag legitimate Geyser clients
    flag: false
    
    # Flag if client claims to be Geyser but isn't a Floodgate player
    flag-non-floodgate: true
    
    # Alert settings
    alert: true
    alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cGeyser client spoofing"
    console-alert-message: "%player% flagged! Geyser client spoofing with brand: %brand%"
    discord-alert: true
    
    # Punishment settings
    punish: false
    punishments:
      - "kick %player% &cGeyser client spoofing detected"

  # =================== LUNAR CLIENT ===================
  # Legitimate client with required channels
  # ====================================================
  lunar:
    # Whether this profile is enabled
    enabled: true
    
    # Match Lunar Client brand pattern
    patterns:
      - "^lunarclient:v\\d+\\.\\d+\\.\\d+-\\d{4}$"
    
    # Channel rules
    channels:
      # Lunar client must have at least one lunar channel
      required:
        - "lunar.*"
      # No specifically blocked channels
      blocked: []
      alert: true
      alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cPossible Lunar client spoofing"
      alert-message-console: "%player% flagged! Possible Lunar client spoofing"
      discord-alert: true
      discord-alert-message: "Possible Lunar client spoofing"
      punish: false
      punishments:
        - "kick %player% &cPossible Lunar Client spoofing"
    
    # Don't flag genuine Lunar clients
    flag: false
    
    # Alert settings (for information only)
    alert: true
    alert-message: "&8[&eAntiSpoof&8] &7%player% is using &9Lunar Client &7version: &b%brand%"
    console-alert-message: "%player% is using Lunar Client: %brand%"
    discord-alert: false
    discord-alert-message: ""
    
    # Punishment settings
    punish: false
    punishments: []

  # =============== FAKE LUNAR CLIENT =================
  # Bad Lunar client brand string
  # ===================================================
  fake-lunar:
    # Whether this profile is enabled
    enabled: true
    
    # Nearly match Lunar Client brand pattern
    patterns:
      - "^(?!lunarclient:v\d+\.\d+\.\d+-\d{4}$).*?(?i)lunar.*"
    
    # Flag fake Lunar clients
    flag: true
    
    # Alert settings (for information only)
    alert: true
    alert-message: "&8[&eAntiSpoof&8] &7%player% flagged! Using &cFake Lunar: %brand%"
    console-alert-message: "%player% flagged! Using Fake Lunar: %brand%"
    discord-alert: true
    discord-alert-message: "Using Fake Lunar: `%brand%`"
    
    # Punishment settings
    punish: false
    punishments: []

  # =================== FABRIC CLIENT ===================
  # Legitimate modding platform with required channels
  # =====================================================
  fabric:
    # Whether this profile is enabled
    enabled: true
    
    # Match Fabric client brand
    patterns:
      - "^fabric$"
    
    # Channel rules
    channels:
      # Fabric should have at least one fabric channel
      required:
        - "(?i).*fabric.*"
      
      # No specifically blocked channels
      blocked: []
      alert: true
      alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cFabric without Fabric channels"
      alert-message-console: "%player% flagged! Fabric without Fabric channels"
      discord-alert: true
      discord-alert-message: "Fabric without Fabric channels"
      punish: false
      punishments:
        - "kick %player% &cFabric without Fabric channels"
    
    # Don't flag genuine Fabric clients
    flag: false
    
    # Alert settings (for information only)
    alert: true
    alert-message: "&8[&eAntiSpoof&8] &7%player% is using &bFabric"
    console-alert-message: "%player% is using Fabric: %brand%"
    discord-alert: false
    discord-alert-message: "Using Fabric"
    
    # Punishment settings
    punish: false
    punishments: []

  # =================== FORGE CLIENT ===================
  # Legitimate modding platform
  # ====================================================
  forge:
    # Whether this profile is enabled
    enabled: true
    
    # Match Forge client brand patterns
    patterns:
      - "^fml,forge.*"
      - "^forge.*"
    
    # Channel rules
    channels:
      # Forge should have at least one forge channel
      required:
        - "(?i).*forge.*"
        - "(?i).*fml.*"
      # No specifically blocked channels
      blocked: []
      alert: true
      alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cForge without Forge channels"
      alert-message-console: "%player% flagged! Forge without Forge channels"
      discord-alert: true
      discord-alert-message: "Forge without Forge channels"
      punish: false
      punishments:
        - "kick %player% &cForge without Forge channels"
    
    # Don't flag genuine Forge clients
    flag: false
    
    # Alert settings (for information only)
    alert: true
    alert-message: "&8[&eAntiSpoof&8] &7%player% is using &bForge"
    console-alert-message: "%player% is using Forge: %brand%"
    discord-alert: false
    discord-alert-message: "Using Forge"
    
    # Punishment settings
    punish: false
    punishments: []

  # =================== HACKED CLIENTS ===================
  # Known hack clients with distinctive brand patterns
  # ======================================================
  hacked:
    # Whether this profile is enabled
    enabled: true
    
    # Match common hack client brand patterns
    patterns:
      - "(?i).*wurst.*"
      - "(?i).*impact.*"
      - "(?i).*aristois.*"
      - "(?i).*future.*"
      - "(?i).*meteor.*"
      - "(?i).*inertia.*"
      - "(?i).*sigma.*"
      - "(?i).*liquidbounce.*"
    
    # Always flag these clients
    flag: true
    
    # Alert settings
    alert: true
    alert-message: "&8[&cAntiSpoof&8] &e%player% is using &c&lknown hacked client: &f%brand%"
    console-alert-message: "ALERT! %player% is using known hacked client: %brand%"
    discord-alert: true
    discord-alert-message: "Using known hacked client: `%brand%`"
    
    # Punishment settings
    punish: true
    punishments:
      - "kick %player% &cHacked client detected: %brand%"
      # Uncomment to ban instead
      # - "ban %player% &cUse of hacked client detected"

  # =================== SUPER STRICT MODE ====================
  # Flag any non-vanilla client that may have plugin channels
  # This is an extremely strict mode and is disabled by default
  # ==========================================================
  any-except-vanilla:
    # Whether this profile is enabled (disabled by default)
    enabled: false
    
    # Match any brand EXCEPT "vanilla" exactly
    patterns:
      - "^(?!vanilla$).*$"
    
    # Channel rules
    channels:
      # No specific required channels
      required: []
      # All channels are blocked
      blocked: [".*"]
      alert: true
      alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cClient modifications detected"
      alert-message-console: "%player% flagged! Client modifications detected"
      discord-alert: true
      discord-alert-message: "Client modifications detected"
      punish: false
      punishments:
        - "kick %player% &cClient modifications detected"
    
    # Flag any matching client
    flag: true
    
    # Alert settings
    alert: true
    alert-message: "&8[&cAntiSpoof&8] &e%player% flagged! &cClient modifications detected"
    console-alert-message: "%player% flagged! Client modifications detected"
    discord-alert: true
    discord-alert-message: "Client modifications detected"
    
    # Punishment settings
    punish: true
    punishments:
      - "kick %player% &cNon-vanilla client or channels detected"

  # ================== FAKE VANILLA ===================
  # Detect fake vanilla clients (capitalized or modified)
  # ===================================================
  fake-vanilla:
    # Whether this profile is enabled
    enabled: true
    
    # Match anything containing "vanilla" but not exactly "vanilla"
    patterns:
      - "^(?!vanilla$).*?(?i)vanilla.*"
    
    # Flag these clients
    flag: true
    
    # Alert settings
    alert: true
    alert-message: "&8[&cAntiSpoof&8] &e%player% using fake Vanilla: &c%brand%"
    console-alert-message: "%player% is using fake Vanilla: %brand%"
    discord-alert: true
    discord-alert-message: "Using fake Vanilla: `%brand%`"

    # Punishment settings
    punish: false
    punishments: []